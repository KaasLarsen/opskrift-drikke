<!doctype html>
<html lang="da">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>Opskrift – opskrift-drikke.dk</title>

    <link rel="preconnect" href="https://cdn.jsdelivr.net"/>
    <script src="https://cdn.tailwindcss.com"></script>

    <meta name="description" content="drikkeopskrifter med søgning, favoritter og kommentarer."/>
    <link rel="icon" href="/assets/favicon.svg" type="image/svg+xml">
    <link rel="manifest" href="/assets/manifest.json">
    <meta property="og:title" content="opskrift-drikke.dk"/>
    <meta property="og:description" content="3.000 drikkeopskrifter – søg, gem og bedøm."/>
    <meta property="og:type" content="website"/>
    <meta property="og:url" content="https://opskrift-drikke.dk/"/>
    <link rel="sitemap" type="application/xml" title="Sitemap" href="/sitemap.xml"/>

    <!-- app boot (henter header/footer + theme + cookies) -->
    <script type="module" src="/js/app.js"></script>
    <!-- analytics (loader kun efter cookie-samtykke) -->
    <script defer src="/js/analytics.js"></script>

    <style>
      .card { border-radius: 1rem; box-shadow: 0 4px 18px rgba(0,0,0,.06); }
      .btn { border-radius: 1rem; }
    </style>
  </head>
  <body class="bg-stone-50 text-stone-900">
    <!-- guard: hvis URL er /pages/opskrift uden .html, redirecter pænt -->
    <script>
      (function () {
        var p = location.pathname.replace(/\/+$/, '');
        if (p.endsWith('/pages/opskrift')) {
          location.replace('/pages/opskrift.html' + location.search + location.hash);
        }
      })();
    </script>

    <div id="header"></div>

    <main class="max-w-6xl mx-auto px-4">
      <section class="pt-8" id="recipePage">
        <nav class="text-sm">
          <a href="/index.html" class="hover:underline">Forside</a> /
          <span id="breadcrumbTitle">Opskrift</span>
        </nav>

        <h1 id="recipeTitle" class="text-3xl font-semibold mt-2">Indlæser...</h1>

        <div class="mt-3 flex flex-wrap items-center gap-4 text-sm">
          <div id="ratingStars" class="flex items-center gap-1"></div>
          <div class="inline-flex items-center gap-2">
            <span>Din bedømmelse:</span>
            <div id="userRating" class="flex items-center gap-1 cursor-pointer"></div>
          </div>
          <button id="favBtn" class="btn border px-3 py-1.5 inline-flex items-center gap-2">
            <svg class="w-4 h-4"><use href="/assets/icons.svg#heart"/></svg><span>Gem</span>
          </button>
          <span id="metaInfo" class="opacity-80"></span>
        </div>

        <div class="mt-6 grid md:grid-cols-3 gap-8">
          <div class="md:col-span-2">
            <div class="card bg-white p-6">
              <h2 class="text-xl font-medium">Ingredienser</h2>
              <ul id="ingredients" class="list-disc ml-6 mt-2"></ul>
            </div>

            <div class="card bg-white p-6 mt-6">
              <h2 class="text-xl font-medium">Sådan gør du</h2>
              <ol id="steps" class="list-decimal ml-6 mt-2 space-y-2"></ol>
            </div>

            <div class="card bg-white p-6 mt-6">
              <h2 class="text-xl font-medium">Kommentarer</h2>
              <div id="commentList" class="mt-3 space-y-4"></div>
              <div id="commentFormWrap" class="mt-4">
                <textarea id="commentText" class="w-full border rounded-2xl p-3" placeholder="Skriv en kommentar..."></textarea>
                <button id="commentSubmit" class="btn border px-3 py-1.5 mt-2">Send</button>
                <p id="commentHint" class="text-sm opacity-70 mt-1">Du skal være logget ind.</p>
              </div>
            </div>
          </div>

          <aside class="md:col-span-1">
            <div class="card bg-white p-6">
              <h3 class="text-lg font-medium">Relaterede</h3>
              <ul id="relatedList" class="mt-2 space-y-2"></ul>
            </div>
            <div class="card bg-white p-6 mt-6">
              <h3 class="text-lg font-medium">Del</h3>
              <p>Kopiér linket og del med en ven.</p>
            </div>
          </aside>
        </div>

        <!-- fallback fejlbesked hvis data slet ikke kan hentes -->
        <noscript>
          <p class="mt-6 p-4 bg-amber-50 border rounded-2xl">du skal slå javascript til for at se opskriften.</p>
        </noscript>
        <div id="recipeError" class="hidden mt-6 p-4 bg-rose-50 border rounded-2xl">
          kunne ikke indlæse opskriften. prøv at genindlæse siden.
        </div>
      </section>

      <!-- sidens logik -->
      <script type="module">
        import '/js/recipe-page.js';
        // lille watcher: hvis vi efter 4 sekunder stadig står på "Indlæser...", vis hjælpetekst
        setTimeout(() => {
          const h = document.getElementById('recipeTitle');
          if (h && /indl\u00e6ser/i.test(h.textContent || '')) {
            document.getElementById('recipeError')?.classList.remove('hidden');
          }
        }, 4000);
      </script>
    </main>

    <div id="footer"></div>
  </body>
</html>
